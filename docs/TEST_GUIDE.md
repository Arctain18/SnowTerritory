# 测试指南

本指南将帮助您测试 SnowTerritory 插件的各项功能。

## 前置准备

### 1. 环境要求
- Paper/Spigot 1.21.1 服务器
- MMOItems 6.9.5+ 插件
- （可选）Vault + 经济插件（如 EssentialsX）
- （可选）PlayerPoints 插件
- （可选）MythicMobs 5.7.2+ 插件（用于 EnderStorage 自动拾取）

### 2. 安装步骤
1. 将编译好的 `SnowTerritory-1.0.jar` 放入 `plugins` 文件夹
2. 启动服务器
3. 检查控制台是否显示 "SnowTerritory 插件已启用"
4. 确认配置文件已生成：
   - `plugins/SnowTerritory/config.yml` - Reinforce 模块配置
   - `plugins/SnowTerritory/ender-storage/` - EnderStorage 模块配置

## 功能测试清单

### ✅ Reinforce（强化）模块测试

#### 1. 插件加载测试
- [ ] 启动服务器，检查插件是否正常加载
- [ ] 检查控制台是否有错误信息
- [ ] 确认配置文件已生成
- [ ] 确认 EnderStorage 模块已启用

#### 2. 命令测试
- [ ] 执行 `/sn` - 应该显示帮助信息
- [ ] 执行 `/sn r` - 应该打开强化 GUI 界面
- [ ] 执行 `/sn r <玩家名>` - 应该为其他玩家打开界面（需权限）
- [ ] 执行 `/sn checkid` - 应该显示手中物品的 MMOItems ID
- [ ] 执行 `/sn reload` - 应该重载配置并显示成功消息
- [ ] 测试权限：非 OP 玩家无法使用命令

#### 3. GUI 界面测试
- [ ] 打开 GUI，检查界面是否正确显示
- [ ] 检查装饰性玻璃板是否正确显示
- [ ] 检查确认和取消按钮是否正确显示
- [ ] 尝试点击不可编辑的槽位（应该被阻止）
- [ ] 尝试点击可编辑的槽位（应该可以放置物品）

#### 4. 基础强化测试
- [ ] 准备一个 MMOItems 物品（如武器）
- [ ] 打开 GUI，将物品放入武器槽位
- [ ] 不放置任何材料，点击确认（应该提示材料不足）
- [ ] 放置所需数量的材料
- [ ] 点击确认进行强化
- [ ] 检查强化结果（成功/失败/维持）

#### 5. 强化结果测试
- [ ] **成功测试**：多次强化，观察成功时：
  - 物品名称是否添加了 "+N" 后缀
  - 物品属性是否提升
  - 是否显示成功消息
- [ ] **失败降级测试**：观察失败时：
  - 物品等级是否下降
  - 物品属性是否降低
  - 是否显示失败消息
- [ ] **维持不变测试**：观察维持时：
  - 物品等级和属性是否不变
  - 是否显示维持消息

#### 6. 保护符测试
- [ ] 放置保护符到保护符槽位
- [ ] 进行强化，即使失败也不应该降级
- [ ] 检查保护符是否被消耗

#### 7. 强化符测试
- [ ] 放置强化符到强化符槽位
- [ ] 进行强化，观察成功率是否提升
- [ ] 检查强化符是否被消耗

### ✅ EnderStorage（末影存储）模块测试

#### 8. 命令测试
- [ ] 执行 `/sn es` - 应该打开战利品仓库 GUI
- [ ] 执行 `/stes` - 应该打开战利品仓库 GUI（别名）
- [ ] 执行 `/sn es reload` - 应该重载 EnderStorage 配置（需权限）
- [ ] 执行 `/sn es give <玩家> <物品key> <数量>` - 应该发放物品到仓库（需权限）
- [ ] 测试权限：普通玩家可以打开仓库，但无法使用管理命令

#### 9. GUI 界面测试
- [ ] 打开仓库 GUI，检查界面是否正确显示
- [ ] 检查分页按钮是否正确显示
- [ ] 检查物品显示是否正确（名称、数量、上限）
- [ ] 测试翻页功能

#### 10. 存入物品测试
- [ ] 准备白名单中的物品
- [ ] 左键点击仓库中的物品槽位：应该存入 8 个
- [ ] Shift + 左键：应该存入 64 个
- [ ] 测试存入非白名单物品：应该提示无法存入
- [ ] 测试存入超过上限的物品：应该只存入到上限
- [ ] 测试存入时仓库已满：应该提示容量不足

#### 11. 取出物品测试
- [ ] 右键点击仓库中的物品槽位：应该取出 8 个
- [ ] Shift + 右键：应该取出 64 个
- [ ] 测试取出数量超过库存：应该只取出实际库存数量
- [ ] 测试取出后物品是否正确生成

#### 12. 自动拾取测试（需 MythicMobs）
- [ ] 拥有 `st.loot.auto` 权限的玩家击杀怪物
- [ ] 检查白名单物品是否自动入库
- [ ] 检查掉落物是否被取消（根据配置）
- [ ] 检查是否显示入库消息
- [ ] 测试无权限玩家：掉落物应该正常掉落

#### 13. 容量解锁测试
- [ ] 测试不同 `st.loot.size.X` 权限：仓库容量应该不同
- [ ] 测试不同 `st.loot.stack.X` 权限：单品上限应该不同
- [ ] 测试无权限玩家：应该使用默认容量和上限

#### 14. 数据库测试
- [ ] 存入物品后重启服务器
- [ ] 检查物品是否仍然存在
- [ ] 检查数据是否正确保存

### ✅ 经济系统测试

#### 15. Vault 经济测试（如果已安装）
- [ ] 检查玩家金币余额
- [ ] 尝试强化，金币不足时应该提示
- [ ] 有足够金币时，强化后应该扣除金币
- [ ] 检查扣除的金币数量是否正确

#### 16. PlayerPoints 测试（如果已安装）
- [ ] 检查玩家点券余额
- [ ] 尝试强化，点券不足时应该提示
- [ ] 有足够点券时，强化后应该扣除点券
- [ ] 检查扣除的点券数量是否正确

#### 17. 无经济系统测试
- [ ] 如果未安装 Vault 或 PlayerPoints，插件应该仍然可以工作
- [ ] 控制台应该显示警告信息，但不影响功能

### ✅ 配置测试

#### 18. Reinforce 配置文件测试
- [ ] 修改成功率配置，重载后是否生效
- [ ] 修改消耗配置，重载后是否生效
- [ ] 修改 GUI 布局配置，重载后是否生效
- [ ] 测试无效配置的处理（应该显示警告但不崩溃）

#### 19. EnderStorage 配置文件测试
- [ ] 修改白名单配置，重载后是否生效
- [ ] 修改容量解锁配置，重载后是否生效
- [ ] 修改消息配置，重载后是否生效
- [ ] 测试无效配置的处理（应该显示警告但不崩溃）

#### 20. 可强化物品列表测试
- [ ] 配置 `reinforceable-items` 列表
- [ ] 测试列表中的物品是否可以强化
- [ ] 测试不在列表中的物品是否不能强化
- [ ] 测试空列表（应该允许所有 MMOItems 物品）

### ✅ 边界情况测试

#### 21. 错误处理测试
- [ ] 尝试强化非 MMOItems 物品（应该提示错误）
- [ ] 尝试强化空气（应该提示错误）
- [ ] 在 GUI 关闭时尝试操作（应该正常处理）
- [ ] 测试网络延迟情况下的操作
- [ ] 测试存入非白名单物品（应该提示错误）
- [ ] 测试取出不存在的物品（应该提示错误）

#### 22. 等级边界测试
- [ ] 测试 0 级物品强化
- [ ] 测试高等级物品强化（10+）
- [ ] 测试失败降级到 0 级的情况

#### 23. 容量边界测试
- [ ] 测试仓库容量达到上限
- [ ] 测试单品数量达到上限
- [ ] 测试同时存入多个不同物品

## 测试数据建议

### 测试物品
- 准备多个不同等级的 MMOItems 物品
- 准备不同类型的物品（武器、盔甲等）
- 准备一些非 MMOItems 物品用于错误测试
- 准备白名单中的物品用于 EnderStorage 测试

### 测试材料
- 准备足够的强化材料
- 准备保护符和强化符（如果有）
- 准备不足的材料用于测试

### 测试经济
- 准备不同金币余额的测试账号
- 准备不同点券余额的测试账号

### 测试权限
- 准备不同权限等级的测试账号
- 测试各种权限组合

## 预期结果

### 正常情况
- ✅ 所有命令正常工作
- ✅ GUI 界面正常显示和交互
- ✅ 强化功能正常工作
- ✅ 战利品仓库功能正常工作
- ✅ 经济系统正确扣除
- ✅ 配置重载正常工作
- ✅ 自动拾取正常工作

### 错误情况
- ✅ 错误信息清晰明确
- ✅ 插件不会崩溃
- ✅ 玩家体验良好

## 问题排查

### 如果插件无法加载
1. 检查 MMOItems 是否已安装
2. 检查服务器版本是否兼容
3. 查看控制台错误信息
4. 检查 EnderStorage 模块是否正常初始化

### 如果强化不工作
1. 检查物品是否为有效的 MMOItems 物品
2. 检查配置文件是否正确
3. 检查是否有足够的材料和经济
4. 检查物品是否在可强化列表中

### 如果 GUI 不显示
1. 检查配置文件中的 GUI 配置
2. 检查是否有权限
3. 查看控制台是否有错误

### 如果战利品仓库不工作
1. 检查是否有 `st.loot.use` 权限
2. 检查 EnderStorage 模块是否已启用
3. 检查数据库是否正常初始化
4. 检查物品是否在白名单中
5. 查看控制台是否有错误

## 测试报告模板

```
测试日期: ___________
测试人员: ___________
服务器版本: ___________
插件版本: ___________

Reinforce 模块:
- 基础功能: [ ] 通过 [ ] 失败
- 物品强化: [ ] 通过 [ ] 失败
- 经济系统: [ ] 通过 [ ] 失败
- 配置系统: [ ] 通过 [ ] 失败

EnderStorage 模块:
- 基础功能: [ ] 通过 [ ] 失败
- GUI 交互: [ ] 通过 [ ] 失败
- 自动拾取: [ ] 通过 [ ] 失败
- 数据库: [ ] 通过 [ ] 失败
- 配置系统: [ ] 通过 [ ] 失败

错误处理: [ ] 通过 [ ] 失败

发现的问题:
1. 
2. 
3. 

建议:
1. 
2. 
3. 
```

## 完成测试后

1. 记录所有发现的问题
2. 测试所有边界情况
3. 确认所有功能正常工作
4. 准备部署到生产环境

---

**祝测试顺利！** 🎮

